<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	locale="#{localeBean.usedLocale}"
	xmlns:f="http://java.sun.com/jsf/core">


	<h:form id="form">
		<h2 style="color: #007d4c;">PROYECTOS > COMISIONES</h2>
		<h:panelGrid id="grid" columns="8" width="95%">
			<h:outputLabel for="optionComision" value="Comision:" />
			<p:selectOneMenu id="optionComision" value="#{comisionesBean.comisionSelected}" converter="#{comisionesBean.conversorComision}" style="margin:10px">
				<f:selectItems value="#{comisionesBean.lstComision}" var="com" itemLabel="#{com.codigo} : #{comisionesBean.sdf.format(com.fechaIni)}-#{comisionesBean.sdf.format(com.fechaCierre)}" itemValue="#{prof}" />
				<p:ajax listener="#{comisionesBean.cambiarComision}" update="idTeamTable, comCont, comCred" />
			</p:selectOneMenu>
			
			<h:outputLabel for="comCont" value="Comisión Contado: "  />
			<h:outputLabel id="comCont" value="#{comisionesBean.comisionSelected.comisionContado}%" style="font-weight: bold;"/>  
				 
			
			<h:outputLabel for="comCred" value="Comisión Crédito: " />
			<h:outputLabel id="comCred" value="#{comisionesBean.comisionSelected.comisionCredito}%" style="font-weight: bold;" />

			<h:outputLabel for="optionTeam" value="Equipo:" />
			<p:selectOneMenu id="optionTeam" value="#{comisionesBean.teamSelected}" converter="#{comisionesBean.conversorTeam}" style="margin:10px">
				<f:selectItem itemLabel="[-- Ninguno --]" itemValue="#{null}" />
				<f:selectItems value="#{comisionesBean.lstTeam}" var="prof" itemLabel="#{prof.name} / #{prof.personSupervisor.surnames} #{prof.personSupervisor.names}" itemValue="#{prof}" />
				<p:ajax listener="#{comisionesBean.cargarAsesorPorEquipo}" update="optionAsesor,idTeamTable" />
			</p:selectOneMenu>
			
			<h:outputLabel for="optionAsesor" value="Asesor:" />
                <p:autoComplete scrollHeight="300" styleClass="ui-autocompV" value="#{comisionesBean.personAsesorSelected}" converter="#{comisionesBean.conversorPersonAsesor}" id="optionAsesor" completeMethod="#{comisionesBean.completePersonAsesor}"  
                          var="per" itemLabel="#{per.surnames.concat(' ')}#{per.names}" itemValue="#{per}" forceSelection="true" style="margin:10px"> 
                   <p:ajax update="idTeamTable"/>
                </p:autoComplete>
                 	
           	
		</h:panelGrid>
		
		<p:dataTable var="team" id="idTeamTable" value="#{comisionesBean.lstTeamLazy}" widgetVar="idTeamTable" rowIndexVar="row" paginator="true" rows="15" style="width:100%"
			size="small" emptyMessage="No se encontraron lotes." paginatorPosition="bottom" rowKey="#{lote.id}" selection="#{loteBean.loteSelected}" selectionMode="single">
			
			<p:column width="25px">
                      #{row +1}
        	</p:column>
        	<p:column headerText="Nombre de Equipo" sortBy="#{team.name}"  filterMatchMode="contains" >
				<h:outputText value="#{team.name}"/>
			</p:column>
			<p:column headerText="Supervisor" sortBy="#{team.personSupervisor.surnames}"  filterMatchMode="contains" >
				<h:outputText value="#{team.personSupervisor.surnames} #{team.personSupervisor.names}" />
			</p:column>
		</p:dataTable>

	</h:form>
</ui:composition>